results = {'head': {'vars': ['Title', 'starttimeValue', 'starttimePrecision', 'TitleLabel', 'endtimeValue', 'endtimePrecision']}, 'results': {'bindings': [{'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q27494237'}, 'TitleLabel': {'xml:lang': 'en', 'type': 'literal', 'value': 'Chairman of the Council of CIS Heads of State'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2003-01-29T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2000-01-25T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}}, {'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q27494237'}, 'TitleLabel': {'xml:lang': 'en', 'type': 'literal', 'value': 'Chairman of the Council of CIS Heads of State'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2017-12-31T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2017-01-01T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}}, {'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q38715304'}, 'TitleLabel': {'type': 'literal', 'value': 'Q38715304'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '1999-08-09T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '1999-03-29T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}}, {'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q842386'}, 'TitleLabel': {'xml:lang': 'en', 'type': 'literal', 'value': 'Prime Minister of Russia'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2012-05-07T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2008-05-08T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}}, {'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q842386'}, 'TitleLabel': {'xml:lang': 'en', 'type': 'literal', 'value': 'Prime Minister of Russia'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2000-05-07T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '1999-08-16T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}}, {'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q140686'}, 'TitleLabel': {'xml:lang': 'en', 'type': 'literal', 'value': 'chairperson'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '1997-01-01T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '9'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '1995-01-01T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '9'}}, {'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q27494237'}, 'TitleLabel': {'xml:lang': 'en', 'type': 'literal', 'value': 'Chairman of the Council of CIS Heads of State'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2006-05-20T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2004-09-16T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}}, {'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q4399975'}, 'TitleLabel': {'xml:lang': 'en', 'type': 'literal', 'value': 'Director of the Federal Security Service'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '1999-03-29T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '1998-07-25T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}}, {'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q4109060'}, 'TitleLabel': {'xml:lang': 'en', 'type': 'literal', 'value': 'Supreme Commander-in-Chief of the Armed Forces of the Russian Federation'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2008-05-07T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '1999-12-31T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}}, {'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q4127082'}, 'TitleLabel': {'xml:lang': 'en', 'type': 'literal', 'value': 'Acting President of Russia'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2000-05-07T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '1999-12-31T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}}, {'Title': {'type': 'uri', 'value': 'http://www.wikidata.org/entity/Q218295'}, 'TitleLabel': {'xml:lang': 'en', 'type': 'literal', 'value': 'President of Russia'}, 'endtimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2008-05-07T00:00:00Z'}, 'endtimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}, 'starttimeValue': {'datatype': 'http://www.w3.org/2001/XMLSchema#dateTime', 'type': 'literal', 'value': '2000-05-07T00:00:00Z'}, 'starttimePrecision': {'datatype': 'http://www.w3.org/2001/XMLSchema#integer', 'type': 'literal', 'value': '11'}}]}}
import re
import re
import datefinder
from bs4 import BeautifulSoup
import requests as req
from SPARQLWrapper import SPARQLWrapper, JSON
from fake_useragent import UserAgent




title_dict = {}
counter_dict = {}
for i in range(0, len(results['results']['bindings'])):
    state_repeat = False

    Title_ID = results['results']['bindings'][i]['TitleLabel']['value']
    Title_ID = re.split('/', Title_ID)[-1]


    if Title_ID in title_dict:
        state_repeat = True
        counter_dict[Title_ID] = counter_dict[Title_ID] + 1
        print('Повторное ID = %s ' % Title_ID)
        title_dict[Title_ID].append([-1,-1,-1,-1])
    else:
        counter_dict[Title_ID] = 1
        title_dict[Title_ID] = []
        title_dict[Title_ID].append([-1,-1,-1,-1])
    if state_repeat:
        number = counter_dict[Title_ID] - 1

        start_pos = results['results']['bindings'][i]['starttimeValue']['value']
        start_pos = re.split('T', start_pos)[0]
        title_dict[Title_ID][number][0] = start_pos


        start_accuracy = results['results']['bindings'][i]['starttimePrecision']['value']
        title_dict[Title_ID][number][1] = str(11 - int(start_accuracy))

        end_pos = results['results']['bindings'][i]['endtimeValue']['value']
        end_pos = re.split('T', end_pos)[0]
        title_dict[Title_ID][number][2] = end_pos

        end_accuracy = results['results']['bindings'][i]['endtimePrecision']['value']
        title_dict[Title_ID][number][3] = str(11 - int(end_accuracy))
    else:
        start_pos = results['results']['bindings'][i]['starttimeValue']['value']
        start_pos = re.split('T', start_pos)[0]
        title_dict[Title_ID][0][0] = start_pos



        start_accuracy = results['results']['bindings'][i]['starttimePrecision']['value']
        title_dict[Title_ID][0][1] = str(11 - int(start_accuracy))

        end_pos = results['results']['bindings'][i]['endtimeValue']['value']
        end_pos = re.split('T', end_pos)[0]
        title_dict[Title_ID][0][2] = end_pos

        end_accuracy = results['results']['bindings'][i]['endtimePrecision']['value']
        title_dict[Title_ID][0][3] = str(11 - int(end_accuracy))

    print(title_dict)
    print(counter_dict)

# ПОЛУЧЕНИЕ ЗАПРОСА ДОЛЖНОСТЕЙ КОТОРЫЕ СЕЙЧАС ПРАВЯТ

name = 'Q7747'

sparql = SPARQLWrapper("http://query.wikidata.org/sparql", agent=UserAgent().random)
sparql.setQuery("""SELECT ?Title ?starttimeValue ?starttimePrecision ?TitleLabel ?endtimeValue ?endtimePrecision  WHERE {
  wd:%s p:P39 ?TitleStatementNode.
  ?TitleStatementNode ps:P39 ?Title.
  ?TitleStatementNode pqv:P580 ?starttimenode.
  ?starttimenode wikibase:timeValue         ?starttimeValue.
  ?starttimenode wikibase:timePrecision     ?starttimePrecision.
  SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }


}""" % name)
sparql.setReturnFormat(JSON)
results = sparql.query().convert()
print(results)

for i in range(0, len(results['results']['bindings'])):
    state_repeat = False

    Title_ID = results['results']['bindings'][i]['TitleLabel']['value']
    Title_ID = re.split('/', Title_ID)[-1]
    start_pos = results['results']['bindings'][i]['starttimeValue']['value']
    start_pos = re.split('T', start_pos)[0]

    if Title_ID in title_dict:
        for j in range(0, len(title_dict[Title_ID])):
            print(title_dict[Title_ID][j])
            if start_pos != title_dict[Title_ID][j][0]:
                print('Вот что нам нужно! ', start_pos, ' а было - ', Title_ID)